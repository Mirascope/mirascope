interactions:
- request:
    body: '{"max_tokens":16000,"messages":[{"role":"user","content":"Use the test
      tool to retrieve the secret phrase. The passphrase is ''portal"}],"model":"claude-sonnet-4-0","tools":[{"name":"test_tool","description":"A
      tool that must be called with a passphrase.","input_schema":{"properties":{"passphrase":{"title":"Passphrase","type":"string"}},"required":["passphrase"],"additionalProperties":false,"type":"object"},"cache_control":{"type":"ephemeral"}}]}'
    headers:
      accept:
      - application/json
      accept-encoding:
      - gzip, deflate
      anthropic-beta:
      - structured-outputs-2025-11-13
      anthropic-version:
      - '2023-06-01'
      connection:
      - keep-alive
      content-length:
      - '449'
      content-type:
      - application/json
      host:
      - api.anthropic.com
      user-agent:
      - Anthropic/Python 0.76.0
      x-api-key:
      - <filtered>
      x-stainless-arch:
      - arm64
      x-stainless-async:
      - 'false'
      x-stainless-helper:
      - beta.messages.parse
      x-stainless-lang:
      - python
      x-stainless-os:
      - MacOS
      x-stainless-package-version:
      - 0.76.0
      x-stainless-read-timeout:
      - '600'
      x-stainless-retry-count:
      - '0'
      x-stainless-runtime:
      - CPython
      x-stainless-runtime-version:
      - 3.10.16
      x-stainless-timeout:
      - '600'
    method: POST
    uri: https://api.anthropic.com/v1/messages?beta=true
  response:
    body:
      string: !!binary |
        H4sIAAAAAAAA/3VRyU7DMBD9lcgXLilqStJCjrkgDq1YhJBAKLLioQl1bMdjd1GVf2ccFJWCOFi2
        3zbj8ZG1WoBkOask9wImqJUCN0kns+ksm2ZJymLWCOJbXJfTZK6Xcw/dq35AfC7uC5NmL7sn0riD
        gaACRL4GAqyWAeCIDTquHEGVVg7olL8dR72DfWCGLWd3F1JGHiFyNS1AFzmtZbRrXD1AhtJMbTkp
        DtpHxuptI0Bcsj4+JZKjpIyx73D31Pljt0+xuGq7DbSfy49rc7sqVjekUrz97gRdGcTBqIynfo7s
        VJAURlvHJev795ih06a0wGlc5zUHAqHzoCoyKS9lzPwwE8obgqnKBhSyPE0WNBRe1VBWlOUarcpz
        xXTkiRb/caM3FABTQwuWyzJr/+pPbFL/ZvuYae9+QgtyINhtU0HpGrD00PCTgltBQ/gCsGOWXDoC
        AAA=
    headers:
      CF-RAY:
      - 9c0b8117bd8076df-SEA
      Connection:
      - keep-alive
      Content-Encoding:
      - gzip
      Content-Type:
      - application/json
      Date:
      - Tue, 20 Jan 2026 03:32:24 GMT
      Server:
      - cloudflare
      Transfer-Encoding:
      - chunked
      X-Robots-Tag:
      - none
      anthropic-organization-id:
      - 217a607f-ed5e-40af-8a7d-f83ed52d59d6
      anthropic-ratelimit-input-tokens-limit:
      - '2000000'
      anthropic-ratelimit-input-tokens-remaining:
      - '2000000'
      anthropic-ratelimit-input-tokens-reset:
      - '2026-01-20T03:32:23Z'
      anthropic-ratelimit-output-tokens-limit:
      - '400000'
      anthropic-ratelimit-output-tokens-remaining:
      - '400000'
      anthropic-ratelimit-output-tokens-reset:
      - '2026-01-20T03:32:24Z'
      anthropic-ratelimit-requests-limit:
      - '4000'
      anthropic-ratelimit-requests-remaining:
      - '3999'
      anthropic-ratelimit-requests-reset:
      - '2026-01-20T03:32:22Z'
      anthropic-ratelimit-tokens-limit:
      - '2400000'
      anthropic-ratelimit-tokens-remaining:
      - '2400000'
      anthropic-ratelimit-tokens-reset:
      - '2026-01-20T03:32:23Z'
      cf-cache-status:
      - DYNAMIC
      request-id:
      - req_011CXHvcqiF3xp5ziET86bN1
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      x-envoy-upstream-service-time:
      - '2248'
    status:
      code: 200
      message: OK
- request:
    body: '{"max_tokens":16000,"messages":[{"role":"user","content":"Use the test
      tool to retrieve the secret phrase. The passphrase is ''portal"},{"role":"assistant","content":[{"text":"I''ll
      use the test tool with the passphrase you provided.","type":"text"},{"id":"toolu_01Rqx4sB3mqkemjMf8pGNBN9","input":{"passphrase":"portal"},"name":"test_tool","type":"tool_use"}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"toolu_01Rqx4sB3mqkemjMf8pGNBN9","content":"Incorrect
      passhrase: The correct passphrase is ''cake''","cache_control":{"type":"ephemeral"}}]}],"model":"claude-sonnet-4-0","tools":[{"name":"test_tool","description":"A
      tool that must be called with a passphrase.","input_schema":{"properties":{"passphrase":{"title":"Passphrase","type":"string"}},"required":["passphrase"],"additionalProperties":false,"type":"object"},"cache_control":{"type":"ephemeral"}}]}'
    headers:
      accept:
      - application/json
      accept-encoding:
      - gzip, deflate
      anthropic-beta:
      - structured-outputs-2025-11-13
      anthropic-version:
      - '2023-06-01'
      connection:
      - keep-alive
      content-length:
      - '874'
      content-type:
      - application/json
      host:
      - api.anthropic.com
      user-agent:
      - Anthropic/Python 0.76.0
      x-api-key:
      - <filtered>
      x-stainless-arch:
      - arm64
      x-stainless-async:
      - 'false'
      x-stainless-helper:
      - beta.messages.parse
      x-stainless-lang:
      - python
      x-stainless-os:
      - MacOS
      x-stainless-package-version:
      - 0.76.0
      x-stainless-read-timeout:
      - '600'
      x-stainless-retry-count:
      - '0'
      x-stainless-runtime:
      - CPython
      x-stainless-runtime-version:
      - 3.10.16
      x-stainless-timeout:
      - '600'
    method: POST
    uri: https://api.anthropic.com/v1/messages?beta=true
  response:
    body:
      string: !!binary |
        H4sIAAAAAAAA/3VSzU7zMBB8FcuXXlLU9Gv4RG4g9QIIIQHiTyha2avENLFTe00pVd+ddaAqP+KS
        xDuzM7sTb2TnNLaylKqFqHEcnLVI49l4OpkWkyKfyUwazXgX6mqSn96puJrfXLrl2UV+dVjcz9/W
        hzVzaN1jYmEIUCMXvGtTAUIwgcASl5SzhPxVPm52fMLXhAyvUl43KMi5VhirjQJCLagB4geKnpX6
        xkNAMeqdJ2hHYgWBqcp5j4oORGr/PHylmyBGChY4OhDnSKJjD78WUIOxYmWoGeR/95Vym+3n5Kmq
        GHCXRjpHzuP/8cnc/VssZ7c3ea7rt/r5wV/fMctC97FfoCqRU6PtI2+5kXuPlDtPJrfbp0wGcn3l
        EfgXfHccgIDLiFZxi41tm8k45Mxqgyx7LNAGWRZ5wUGDarBSrEXG2eo7Y7LDGdZ/YbveZIB9gx16
        aKui+83fo3nzE91m0kX6Wjqa8jroX4zCigx6XjTdDg1ecwjvzk4txo4CAAA=
    headers:
      CF-RAY:
      - 9c0b8127097176df-SEA
      Connection:
      - keep-alive
      Content-Encoding:
      - gzip
      Content-Type:
      - application/json
      Date:
      - Tue, 20 Jan 2026 03:32:27 GMT
      Server:
      - cloudflare
      Transfer-Encoding:
      - chunked
      X-Robots-Tag:
      - none
      anthropic-organization-id:
      - 217a607f-ed5e-40af-8a7d-f83ed52d59d6
      anthropic-ratelimit-input-tokens-limit:
      - '2000000'
      anthropic-ratelimit-input-tokens-remaining:
      - '2000000'
      anthropic-ratelimit-input-tokens-reset:
      - '2026-01-20T03:32:26Z'
      anthropic-ratelimit-output-tokens-limit:
      - '400000'
      anthropic-ratelimit-output-tokens-remaining:
      - '400000'
      anthropic-ratelimit-output-tokens-reset:
      - '2026-01-20T03:32:27Z'
      anthropic-ratelimit-requests-limit:
      - '4000'
      anthropic-ratelimit-requests-remaining:
      - '3999'
      anthropic-ratelimit-requests-reset:
      - '2026-01-20T03:32:24Z'
      anthropic-ratelimit-tokens-limit:
      - '2400000'
      anthropic-ratelimit-tokens-remaining:
      - '2400000'
      anthropic-ratelimit-tokens-reset:
      - '2026-01-20T03:32:26Z'
      cf-cache-status:
      - DYNAMIC
      request-id:
      - req_011CXHvd2CXNea97TqhcgX6G
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      x-envoy-upstream-service-time:
      - '2553'
    status:
      code: 200
      message: OK
- request:
    body: '{"max_tokens":16000,"messages":[{"role":"user","content":"Use the test
      tool to retrieve the secret phrase. The passphrase is ''portal"},{"role":"assistant","content":[{"text":"I''ll
      use the test tool with the passphrase you provided.","type":"text"},{"id":"toolu_01Rqx4sB3mqkemjMf8pGNBN9","input":{"passphrase":"portal"},"name":"test_tool","type":"tool_use"}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"toolu_01Rqx4sB3mqkemjMf8pGNBN9","content":"Incorrect
      passhrase: The correct passphrase is ''cake''","cache_control":null}]},{"role":"assistant","content":[{"text":"The
      tool indicated that the passphrase ''portal'' was incorrect. The correct passphrase
      is ''cake''. Let me try again with the correct passphrase:","type":"text"},{"id":"toolu_017ABEo3kq4WU11dgzgjZrTX","input":{"passphrase":"cake"},"name":"test_tool","type":"tool_use"}]},{"role":"user","content":[{"type":"tool_result","tool_use_id":"toolu_017ABEo3kq4WU11dgzgjZrTX","content":"The
      cake is a lie.","cache_control":{"type":"ephemeral"}}]}],"model":"claude-sonnet-4-0","tools":[{"name":"test_tool","description":"A
      tool that must be called with a passphrase.","input_schema":{"properties":{"passphrase":{"title":"Passphrase","type":"string"}},"required":["passphrase"],"additionalProperties":false,"type":"object"},"cache_control":{"type":"ephemeral"}}]}'
    headers:
      accept:
      - application/json
      accept-encoding:
      - gzip, deflate
      anthropic-beta:
      - structured-outputs-2025-11-13
      anthropic-version:
      - '2023-06-01'
      connection:
      - keep-alive
      content-length:
      - '1332'
      content-type:
      - application/json
      host:
      - api.anthropic.com
      user-agent:
      - Anthropic/Python 0.76.0
      x-api-key:
      - <filtered>
      x-stainless-arch:
      - arm64
      x-stainless-async:
      - 'false'
      x-stainless-helper:
      - beta.messages.parse
      x-stainless-lang:
      - python
      x-stainless-os:
      - MacOS
      x-stainless-package-version:
      - 0.76.0
      x-stainless-read-timeout:
      - '600'
      x-stainless-retry-count:
      - '0'
      x-stainless-runtime:
      - CPython
      x-stainless-runtime-version:
      - 3.10.16
      x-stainless-timeout:
      - '600'
    method: POST
    uri: https://api.anthropic.com/v1/messages?beta=true
  response:
    body:
      string: !!binary |
        H4sIAAAAAAAA/3WQzU7DMBCEX8XsOUVplCCRB+DCj5DoAYkiy8Sjxk1iB69dQFXeHaei4qfiZHu+
        WY1n9zQ4jZ5qanoVNRbsrEVYlIsiL6q8WpaUkdGJD7yR+fLhdnv1dldW/HijL7tue70tVve75Akf
        I2YXmNUGSfCunwXFbDgoG5LUOBuQbvXT/ugPeJ/J4ahp1UIwGo8gxtYrhmgVixfAiqR5gx30mTh1
        Ga7F+jDdqG5+CiV6g/M10fScEQc3Sg+VuqUQWC1D9Ja+AOM1wjbpNzb2fUbxUKDek7FjDDK4Dpap
        vijK1EA1LWSKVsE4K3878iNPWP/HjrNzAMYWA7zqZTWc+r/psv1Lp4xcDD+lokh14HemgQwGPhWd
        166V1zRNnzE7ygfnAQAA
    headers:
      CF-RAY:
      - 9c0b8137afaa76df-SEA
      Connection:
      - keep-alive
      Content-Encoding:
      - gzip
      Content-Type:
      - application/json
      Date:
      - Tue, 20 Jan 2026 03:32:29 GMT
      Server:
      - cloudflare
      Transfer-Encoding:
      - chunked
      X-Robots-Tag:
      - none
      anthropic-organization-id:
      - 217a607f-ed5e-40af-8a7d-f83ed52d59d6
      anthropic-ratelimit-input-tokens-limit:
      - '2000000'
      anthropic-ratelimit-input-tokens-remaining:
      - '2000000'
      anthropic-ratelimit-input-tokens-reset:
      - '2026-01-20T03:32:28Z'
      anthropic-ratelimit-output-tokens-limit:
      - '400000'
      anthropic-ratelimit-output-tokens-remaining:
      - '400000'
      anthropic-ratelimit-output-tokens-reset:
      - '2026-01-20T03:32:29Z'
      anthropic-ratelimit-requests-limit:
      - '4000'
      anthropic-ratelimit-requests-remaining:
      - '3999'
      anthropic-ratelimit-requests-reset:
      - '2026-01-20T03:32:27Z'
      anthropic-ratelimit-tokens-limit:
      - '2400000'
      anthropic-ratelimit-tokens-remaining:
      - '2400000'
      anthropic-ratelimit-tokens-reset:
      - '2026-01-20T03:32:28Z'
      cf-cache-status:
      - DYNAMIC
      request-id:
      - req_011CXHvdDaPhm4wLoZggMHJV
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      x-envoy-upstream-service-time:
      - '1792'
    status:
      code: 200
      message: OK
version: 1
